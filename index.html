<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game WebApp</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        body {
            background: #0d0d0d;
            color: white;
            font-family: sans-serif;
        }

        .screen {
            display: none;
        }

        .active-screen {
            display: block;
        }

        .nav-btn {
            opacity: 0.5;
            transition: 0.2s;
        }

        .nav-btn.active {
            opacity: 1;
        }
    </style>
</head>

<body class="h-screen flex flex-col">

    <!-- –≠–ö–†–ê–ù PVP -->
    <div id="screen-pvp" class="screen active-screen p-4">
        <h1 class="text-3xl font-bold mb-4">PVP</h1>
        <p class="opacity-70">–≠–∫—Ä–∞–Ω PVP –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏.</p>
    </div>

    <!-- –≠–ö–†–ê–ù –ò–ì–† -->
    <div id="screen-games" class="screen p-4">
        <h1 class="text-3xl font-bold mb-4">–ò–≥—Ä—ã</h1>
        <p class="opacity-70">–ò–≥—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏.</p>
    </div>

    <!-- –≠–ö–†–ê–ù –ü–†–û–§–ò–õ–Ø -->
    <div id="screen-profile" class="screen p-4">
        <h1 class="text-3xl font-bold mb-4">–ü—Ä–æ—Ñ–∏–ª—å</h1>
        <p class="opacity-70">–ü—Ä–æ—Ñ–∏–ª—å –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–∑–∂–µ.</p>
    </div>

    <!-- –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
    <div class="mt-auto bg-black/40 backdrop-blur-md p-3 flex justify-around border-t border-white/10">
        <button class="nav-btn active" onclick="openScreen('pvp')">PVP</button>
        <button class="nav-btn" onclick="openScreen('games')">–ò–≥—Ä—ã</button>
        <button class="nav-btn" onclick="openScreen('profile')">–ü—Ä–æ—Ñ–∏–ª—å</button>
    </div>

    <script>
        function openScreen(name) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
            document.querySelector(`#screen-${name}`).classList.add('active-screen');

            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
        }
    </script>

</body>
</html>
<!-- –≠–ö–†–ê–ù PVP -->
<div id="screen-pvp" class="screen active-screen p-4">

    <h1 class="text-3xl font-bold mb-4">PVP</h1>

    <!-- –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É -->
    <div class="bg-white/5 p-4 rounded-xl border border-white/10 mb-4">
        <h2 class="text-xl font-semibold mb-2">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</h2>

        <input id="pvpRoomName" 
               class="w-full p-2 rounded bg-black/40 border border-white/10 mb-3"
               placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã">

        <button onclick="createRoom()"
                class="w-full py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition">
            –°–æ–∑–¥–∞—Ç—å
        </button>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç -->
    <div class="bg-white/5 p-4 rounded-xl border border-white/10">
        <h2 class="text-xl font-semibold mb-3">–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã</h2>

        <div id="pvpRoomList" class="space-y-3 text-white/80">
            <!-- –ö–æ–º–Ω–∞—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –∑–¥–µ—Å—å -->
        </div>
    </div>

</div>

<script>
    let rooms = [];

    function createRoom() {
        const name = document.getElementById("pvpRoomName").value.trim();
        if (!name) return;

        const room = {
            id: Date.now(),
            name: name
        };

        rooms.push(room);
        renderRooms();

        gsap.from(`#room-${room.id}`, {
            opacity: 0,
            y: 20,
            duration: 0.3
        });

        document.getElementById("pvpRoomName").value = "";
    }

    function renderRooms() {
        const list = document.getElementById("pvpRoomList");
        list.innerHTML = "";

        rooms.forEach(room => {
            const div = document.createElement("div");
            div.id = `room-${room.id}`;
            div.className = "p-3 bg-black/30 rounded-lg border border-white/10 flex justify-between items-center";

            div.innerHTML = `
                <span>${room.name}</span>
                <button onclick="joinRoom(${room.id})"
                        class="px-3 py-1 bg-green-600 hover:bg-green-700 rounded">
                    –í–æ–π—Ç–∏
                </button>
            `;

            list.appendChild(div);
        });
    }

    function joinRoom(id) {
        const room = rooms.find(r => r.id === id);
        if (!room) return;

        alert("–¢—ã –≤–æ—à—ë–ª –≤ –∫–æ–º–Ω–∞—Ç—É: " + room.name);
    }
</script>
<!-- –≠–ö–†–ê–ù –ò–ì–† -->
<div id="screen-games" class="screen p-4">

    <h1 class="text-3xl font-bold mb-4">–ò–≥—Ä—ã</h1>

    <div class="grid grid-cols-1 gap-4">

        <!-- Coin Flip -->
        <div onclick="openCoinFlip()"
             class="p-4 bg-white/5 border border-white/10 rounded-xl cursor-pointer hover:bg-white/10 transition">
            <h2 class="text-xl font-semibold">Coin Flip</h2>
            <p class="opacity-70 text-sm">–ü–æ–¥–±—Ä–æ—Å—å –º–æ–Ω–µ—Ç–∫—É –∏ –ø—Ä–æ–≤–µ—Ä—å —É–¥–∞—á—É</p>
        </div>

        <!-- Roulette -->
        <div onclick="openRoulette()"
             class="p-4 bg-white/5 border border-white/10 rounded-xl cursor-pointer hover:bg-white/10 transition">
            <h2 class="text-xl font-semibold">Roulette</h2>
            <p class="opacity-70 text-sm">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ä—É–ª–µ—Ç–∫–∞ —Å –≤—Ä–∞—â–µ–Ω–∏–µ–º</p>
        </div>

        <!-- RPS -->
        <div onclick="openRPS()"
             class="p-4 bg-white/5 border border-white/10 rounded-xl cursor-pointer hover:bg-white/10 transition">
            <h2 class="text-xl font-semibold">–ö–∞–º–µ–Ω—å, –Ω–æ–∂–Ω–∏—Ü—ã, –±—É–º–∞–≥–∞</h2>
            <p class="opacity-70 text-sm">–ò–≥—Ä–∞–π –ø—Ä–æ—Ç–∏–≤ –±–æ—Ç–∞</p>
        </div>

    </div>

</div>

<script>
    function openCoinFlip() {
        gsap.from("#screen-games", {opacity: 0.5, duration: 0.2});
        alert("Coin Flip –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ —á–∞—Å—Ç–∏ 4");
    }

    function openRoulette() {
        gsap.from("#screen-games", {opacity: 0.5, duration: 0.2});
        alert("Roulette –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ —á–∞—Å—Ç–∏ 5");
    }

    function openRPS() {
        gsap.from("#screen-games", {opacity: 0.5, duration: 0.2});
        alert("RPS –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ —á–∞—Å—Ç–∏ 6");
    }
</script>
<!-- COIN FLIP MODAL -->
<div id="coinModal" class="fixed inset-0 bg-black/70 backdrop-blur-md hidden items-center justify-center">
    <div class="bg-white/10 border border-white/20 p-6 rounded-2xl w-80 text-center">

        <h2 class="text-2xl font-bold mb-4">Coin Flip</h2>

        <!-- –ú–æ–Ω–µ—Ç–∫–∞ -->
        <div id="coin" class="mx-auto mb-4 w-24 h-24 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-black font-bold text-xl shadow-xl">
            ?
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ -->
        <div class="flex justify-around mb-4">
            <button onclick="startFlip('–û—Ä—ë–ª')" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg">–û—Ä—ë–ª</button>
            <button onclick="startFlip('–†–µ—à–∫–∞')" class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg">–†–µ—à–∫–∞</button>
        </div>

        <button onclick="closeCoinFlip()" class="mt-2 text-white/60 hover:text-white">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<script>
    function openCoinFlip() {
        const modal = document.getElementById("coinModal");
        modal.classList.remove("hidden");

        gsap.from(modal, {opacity: 0, duration: 0.3});
        gsap.from("#coin", {scale: 0, duration: 0.3});
    }

    function closeCoinFlip() {
        document.getElementById("coinModal").classList.add("hidden");
    }

    function startFlip(choice) {
        const coin = document.getElementById("coin");

        gsap.to(coin, {
            rotationY: 720,
            duration: 1,
            ease: "power2.inOut",
            onComplete: () => {
                const result = Math.random() < 0.5 ? "–û—Ä—ë–ª" : "–†–µ—à–∫–∞";
                coin.textContent = result;

                gsap.from(coin, {scale: 0.5, duration: 0.3});

                setTimeout(() => {
                    alert(result === choice ? "–¢—ã –≤—ã–∏–≥—Ä–∞–ª!" : "–¢—ã –ø—Ä–æ–∏–≥—Ä–∞–ª!");
                }, 200);
            }
        });
    }
</script>
<!-- ROULETTE MODAL -->
<div id="rouletteModal" class="fixed inset-0 bg-black/70 backdrop-blur-md hidden items-center justify-center">
    <div class="bg-white/10 border border-white/20 p-6 rounded-2xl w-80 text-center">

        <h2 class="text-2xl font-bold mb-4">Roulette</h2>

        <!-- –ö–æ–ª–µ—Å–æ -->
        <div class="relative mx-auto mb-4">
            <div id="rouletteWheel"
                 class="w-48 h-48 rounded-full border-4 border-white/20 overflow-hidden relative"
                 style="background: conic-gradient(
                     #e74c3c 0deg 30deg,
                     #2ecc71 30deg 60deg,
                     #3498db 60deg 90deg,
                     #f1c40f 90deg 120deg,
                     #9b59b6 120deg 150deg,
                     #e67e22 150deg 180deg,
                     #1abc9c 180deg 210deg,
                     #e74c3c 210deg 240deg,
                     #2ecc71 240deg 270deg,
                     #3498db 270deg 300deg,
                     #f1c40f 300deg 330deg,
                     #9b59b6 330deg 360deg
                 );">
            </div>

            <!-- –°—Ç—Ä–µ–ª–∫–∞ -->
            <div class="absolute top-1/2 -right-6 transform -translate-y-1/2">
                <div class="w-0 h-0 border-t-8 border-b-8 border-l-12 border-transparent border-l-white"></div>
            </div>
        </div>

        <button onclick="spinRoulette()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg">
            –ö—Ä—É—Ç–∏—Ç—å
        </button>

        <button onclick="closeRoulette()" class="mt-3 block mx-auto text-white/60 hover:text-white">
            –ó–∞–∫—Ä—ã—Ç—å
        </button>
    </div>
</div>

<script>
    function openRoulette() {
        const modal = document.getElementById("rouletteModal");
        modal.classList.remove("hidden");

        gsap.from(modal, {opacity: 0, duration: 0.3});
        gsap.from("#rouletteWheel", {scale: 0, duration: 0.3});
    }

    function closeRoulette() {
        document.getElementById("rouletteModal").classList.add("hidden");
    }

    function spinRoulette() {
        const wheel = document.getElementById("rouletteWheel");

        const randomSpin = 360 * 5 + Math.floor(Math.random() * 360);

        gsap.to(wheel, {
            rotation: randomSpin,
            duration: 3,
            ease: "power4.out",
            onComplete: () => {
                const finalDeg = randomSpin % 360;
                const sector = Math.floor(finalDeg / 30) + 1;

                alert("–í—ã–ø–∞–ª —Å–µ–∫—Ç–æ—Ä: " + sector);
            }
        });
    }
</script>
<!-- RPS MODAL -->
<div id="rpsModal" class="fixed inset-0 bg-black/70 backdrop-blur-md hidden items-center justify-center">
    <div class="bg-white/10 border border-white/20 p-6 rounded-2xl w-80 text-center">

        <h2 class="text-2xl font-bold mb-4">–ö–∞–º–µ–Ω—å / –ù–æ–∂–Ω–∏—Ü—ã / –ë—É–º–∞–≥–∞<br><span class="text-sm opacity-70">Rock / Paper / Scissors</span></h2>

        <!-- –í—ã–±–æ—Ä –∏–≥—Ä–æ–∫–∞ -->
        <div class="grid grid-cols-3 gap-3 mb-4">
            <button onclick="playRPS('rock')" 
                    class="py-2 bg-blue-600 hover:bg-blue-700 rounded-lg">
                –ö–∞–º–µ–Ω—å<br><span class="text-xs opacity-70">Rock</span>
            </button>

            <button onclick="playRPS('scissors')" 
                    class="py-2 bg-green-600 hover:bg-green-700 rounded-lg">
                –ù–æ–∂–Ω–∏—Ü—ã<br><span class="text-xs opacity-70">Scissors</span>
            </button>

            <button onclick="playRPS('paper')" 
                    class="py-2 bg-purple-600 hover:bg-purple-700 rounded-lg">
                –ë—É–º–∞–≥–∞<br><span class="text-xs opacity-70">Paper</span>
            </button>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
        <div id="rpsResult" class="text-lg font-semibold min-h-[40px]"></div>

        <button onclick="closeRPS()" class="mt-3 block mx-auto text-white/60 hover:text-white">
            –ó–∞–∫—Ä—ã—Ç—å / Close
        </button>
    </div>
</div>

<script>
    function openRPS() {
        const modal = document.getElementById("rpsModal");
        modal.classList.remove("hidden");

        gsap.from(modal, {opacity: 0, duration: 0.3});
    }

    function closeRPS() {
        document.getElementById("rpsModal").classList.add("hidden");
        document.getElementById("rpsResult").innerHTML = "";
    }

    function playRPS(player) {
        const options = ["rock", "paper", "scissors"];
        const bot = options[Math.floor(Math.random() * 3)];

        let resultRU = "";
        let resultEN = "";

        if (player === bot) {
            resultRU = "–ù–∏—á—å—è";
            resultEN = "Draw";
        } else if (
            (player === "rock" && bot === "scissors") ||
            (player === "scissors" && bot === "paper") ||
            (player === "paper" && bot === "rock")
        ) {
            resultRU = "–¢—ã –≤—ã–∏–≥—Ä–∞–ª!";
            resultEN = "You win!";
        } else {
            resultRU = "–¢—ã –ø—Ä–æ–∏–≥—Ä–∞–ª!";
            resultEN = "You lose!";
        }

        const translate = {
            rock: "–ö–∞–º–µ–Ω—å / Rock",
            paper: "–ë—É–º–∞–≥–∞ / Paper",
            scissors: "–ù–æ–∂–Ω–∏—Ü—ã / Scissors"
        };

        document.getElementById("rpsResult").innerHTML = `
            –¢—ã –≤—ã–±—Ä–∞–ª: <b>${translate[player]}</b><br>
            –ë–æ—Ç –≤—ã–±—Ä–∞–ª: <b>${translate[bot]}</b><br><br>
            <span class="text-xl">${resultRU} / ${resultEN}</span>
        `;

        gsap.from("#rpsResult", {opacity: 0, y: 10, duration: 0.3});
    }
</script>
<!-- MARKET SCREEN -->
<div id="screen-market" class="screen p-4">

    <h1 class="text-3xl font-bold mb-4">–ú–∞–≥–∞–∑–∏–Ω –∫–µ–π—Å–æ–≤</h1>

    <div class="grid grid-cols-1 gap-4">

        <!-- GOLD CASE -->
        <div class="p-4 bg-yellow-500/20 border border-yellow-400/40 rounded-xl">
            <h2 class="text-xl font-semibold text-yellow-300">–ó–æ–ª–æ—Ç–æ–π –∫–µ–π—Å</h2>
            <p class="opacity-80 text-sm mb-2">–°–æ–¥–µ—Ä–∂–∏—Ç: –∑–æ–ª–æ—Ç—ã–µ —Å–∫–∏–Ω—ã, –∑–æ–ª–æ—Ç—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</p>

            <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-yellow-300">–¶–µ–Ω–∞: 500</span>
                <button onclick="buyCase('gold')" 
                        class="px-4 py-2 bg-yellow-500 hover:bg-yellow-600 rounded-lg text-black font-bold">
                    –ö—É–ø–∏—Ç—å
                </button>
            </div>
        </div>

        <!-- DIAMOND CASE -->
        <div class="p-4 bg-blue-500/20 border border-blue-400/40 rounded-xl">
            <h2 class="text-xl font-semibold text-blue-300">–ê–ª–º–∞–∑–Ω—ã–π –∫–µ–π—Å</h2>
            <p class="opacity-80 text-sm mb-2">–°–æ–¥–µ—Ä–∂–∏—Ç: –∞–ª–º–∞–∑–Ω—ã–µ —Å–∫–∏–Ω—ã, —Ä–µ–¥–∫–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</p>

            <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-blue-300">–¶–µ–Ω–∞: 1000</span>
                <button onclick="buyCase('diamond')" 
                        class="px-4 py-2 bg-blue-500 hover:bg-blue-600 rounded-lg text-black font-bold">
                    –ö—É–ø–∏—Ç—å
                </button>
            </div>
        </div>

        <!-- DARKNESS CASE -->
        <div class="p-4 bg-purple-500/20 border border-purple-400/40 rounded-xl">
            <h2 class="text-xl font-semibold text-purple-300">–ö–µ–π—Å –¢—å–º—ã</h2>
            <p class="opacity-80 text-sm mb-2">–°–æ–¥–µ—Ä–∂–∏—Ç: –≤–∞–º–ø–∏—Ä—Å–∫–∏–µ, —Ç—ë–º–Ω—ã–µ, —Ä–µ–¥–∫–∏–µ —Å–∫–∏–Ω—ã</p>

            <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-purple-300">–¶–µ–Ω–∞: 1500</span>
                <button onclick="buyCase('dark')" 
                        class="px-4 py-2 bg-purple-500 hover:bg-purple-600 rounded-lg text-black font-bold">
                    –ö—É–ø–∏—Ç—å
                </button>
            </div>
        </div>

    </div>

</div>

<!-- MARKET LOGIC -->
<script>
    let balance = 5000; // –≤—Ä–µ–º–µ–Ω–Ω–æ, –ø–æ—Ç–æ–º –≤—ã–Ω–µ—Å–µ–º –≤ –ø—Ä–æ—Ñ–∏–ª—å
    let inventory = [];

    function buyCase(type) {
        let price = 0;

        if (type === "gold") price = 500;
        if (type === "diamond") price = 1000;
        if (type === "dark") price = 1500;

        if (balance < price) {
            alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");
            return;
        }

        balance -= price;

        alert("–ö–µ–π—Å –∫—É–ø–ª–µ–Ω! –û—Ç–∫—Ä—ã—Ç–∏–µ –±—É–¥–µ—Ç –≤ –ß–∞—Å—Ç–∏ 8.");

        // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–∫—É–ø–∫—É
        inventory.push({
            type: type,
            id: Date.now()
        });

        gsap.from("#screen-market", {opacity: 0.5, duration: 0.3});
    }
</script>
<!-- CASE OPENING MODAL -->
<div id="caseOpenModal" class="fixed inset-0 bg-black/80 backdrop-blur-md hidden items-center justify-center">
    <div class="bg-white/10 border border-white/20 p-6 rounded-2xl w-96 text-center">

        <h2 id="caseTitle" class="text-2xl font-bold mb-4"></h2>

        <!-- –õ–µ–Ω—Ç–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ -->
        <div class="overflow-hidden border border-white/20 rounded-xl mb-4">
            <div id="caseRoll" class="flex gap-2 p-3"
                 style="transform: translateX(0); transition: 3s ease-out;">
            </div>
        </div>

        <div id="caseResult" class="text-xl font-semibold min-h-[40px]"></div>

        <button onclick="closeCaseOpen()" class="mt-3 text-white/60 hover:text-white">
            –ó–∞–∫—Ä—ã—Ç—å
        </button>
    </div>
</div>

<script>
    const caseSkins = {
        gold: [
            { name: "–ó–æ–ª–æ—Ç–æ–π –ø–∏—Å—Ç–æ–ª–µ—Ç", type: "weapon", rarity: "legendary" },
            { name: "–ó–æ–ª–æ—Ç–æ–µ –º–µ–Ω—é", type: "menu", rarity: "epic" },
            { name: "–ó–æ–ª–æ—Ç–æ–π —ç—Ñ—Ñ–µ–∫—Ç", type: "effect", rarity: "rare" }
        ],
        diamond: [
            { name: "–ê–ª–º–∞–∑–Ω—ã–π –ø–∏—Å—Ç–æ–ª–µ—Ç", type: "weapon", rarity: "legendary" },
            { name: "–ê–ª–º–∞–∑–Ω–æ–µ –º–µ–Ω—é", type: "menu", rarity: "epic" },
            { name: "–ê–ª–º–∞–∑–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç", type: "effect", rarity: "rare" }
        ],
        dark: [
            { name: "–í–∞–º–ø–∏—Ä—Å–∫–∏–π –ø–∏—Å—Ç–æ–ª–µ—Ç", type: "weapon", rarity: "legendary" },
            { name: "–¢—ë–º–Ω–æ–µ –º–µ–Ω—é", type: "menu", rarity: "epic" },
            { name: "–ö—Ä–æ–≤–∞–≤—ã–π —ç—Ñ—Ñ–µ–∫—Ç", type: "effect", rarity: "rare" }
        ]
    };

    function openCase(type) {
        const modal = document.getElementById("caseOpenModal");
        const roll = document.getElementById("caseRoll");
        const title = document.getElementById("caseTitle");
        const result = document.getElementById("caseResult");

        modal.classList.remove("hidden");
        roll.innerHTML = "";
        result.innerHTML = "";

        // –ù–∞–∑–≤–∞–Ω–∏–µ
        if (type === "gold") title.textContent = "–û—Ç–∫—Ä—ã—Ç–∏–µ –∑–æ–ª–æ—Ç–æ–≥–æ –∫–µ–π—Å–∞";
        if (type === "diamond") title.textContent = "–û—Ç–∫—Ä—ã—Ç–∏–µ –∞–ª–º–∞–∑–Ω–æ–≥–æ –∫–µ–π—Å–∞";
        if (type === "dark") title.textContent = "–û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞ –¢—å–º—ã";

        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 20 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ª–µ–Ω—Ç–µ
        const pool = caseSkins[type];
        let items = [];

        for (let i = 0; i < 20; i++) {
            const skin = pool[Math.floor(Math.random() * pool.length)];
            items.push(skin);

            const div = document.createElement("div");
            div.className = "min-w-[120px] p-3 rounded-lg text-center text-black font-bold";

            if (skin.rarity === "legendary") div.style.background = "#ffd700";
            if (skin.rarity === "epic") div.style.background = "#8a2be2";
            if (skin.rarity === "rare") div.style.background = "#1e90ff";

            div.textContent = skin.name;
            roll.appendChild(div);
        }

        // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞
        const finalPos = -((Math.floor(Math.random() * 10) + 5) * 120);

        setTimeout(() => {
            roll.style.transform = `translateX(${finalPos}px)`;
        }, 100);

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à
        setTimeout(() => {
            const index = Math.abs(finalPos / 120);
            const win = items[index];

            result.innerHTML = `
                –í—ã–ø–∞–ª —Å–∫–∏–Ω:<br>
                <span class="text-2xl font-bold">${win.name}</span>
            `;

            inventory.push(win);

            gsap.from("#caseResult", {opacity: 0, y: 10, duration
<!-- INVENTORY SCREEN -->
<div id="screen-inventory" class="screen p-4">

    <h1 class="text-3xl font-bold mb-4">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h1>

    <div id="inventoryList" class="grid grid-cols-1 gap-4">
        <!-- –°–∫–∏–Ω—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –∑–¥–µ—Å—å -->
    </div>

</div>

<script>
    // inventory —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–∑ –ø—Ä–æ—à–ª—ã—Ö —á–∞—Å—Ç–µ–π

    function renderInventory() {
        const list = document.getElementById("inventoryList");
        list.innerHTML = "";

        if (inventory.length === 0) {
            list.innerHTML = `
                <div class="p-4 bg-white/5 border border-white/10 rounded-xl text-center opacity-70">
                    –£ —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç —Å–∫–∏–Ω–æ–≤
                </div>
            `;
            return;
        }

        inventory.forEach((skin, index) => {
            const div = document.createElement("div");

            let color = "#ffffff20";
            if (skin.rarity === "legendary") color = "#ffd70040";
            if (skin.rarity === "epic") color = "#8a2be240";
            if (skin.rarity === "rare") color = "#1e90ff40";

            div.className = "p-4 rounded-xl border border-white/10";
            div.style.background = color;

            div.innerHTML = `
                <h2 class="text-xl font-semibold">${skin.name}</h2>
                <p class="opacity-70 text-sm mb-2">–¢–∏–ø: ${skin.type}</p>
                <p class="opacity-70 text-sm mb-2">–†–µ–¥–∫–æ—Å—Ç—å: ${skin.rarity}</p>

                <button onclick="equipSkin(${index})"
                        class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg mt-2">
                    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
                </button>
            `;

            list.appendChild(div);
        });
    }

    function equipSkin(index) {
        const skin = inventory[index];

        alert("–°–∫–∏–Ω –ø—Ä–∏–º–µ–Ω—ë–Ω: " + skin.name);

        // –í –ß–∞—Å—Ç–∏ 10 –º—ã —Å–¥–µ–ª–∞–µ–º:
        // - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫–∏–Ω–∞ –∫ –ø–∏—Å—Ç–æ–ª–µ—Ç—É
        // - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –º–µ–Ω—é
        // - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –∏–≥—Ä–∞–º
        // - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage

        gsap.from("#inventoryList", {opacity: 0.5, duration: 0.3});
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–Ω–¥–µ—Ä –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —ç–∫—Ä–∞–Ω–∞
    function openScreen(name) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        document.querySelector(`#screen-${name}`).classList.add('active-screen');

        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');

        if (name === "inventory") renderInventory();
    }
</script>
<!-- ACTIVE SKINS SYSTEM -->
<script>
    // –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–∫–∏–Ω—ã
    let activeSkins = {
        weapon: null,
        menu: null,
        effect: null
    };

    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫–∏–Ω–∞
    function equipSkin(index) {
        const skin = inventory[index];

        if (!skin) return;

        // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫–∏–Ω
        activeSkins[skin.type] = skin;

        alert("–°–∫–∏–Ω –ø—Ä–∏–º–µ–Ω—ë–Ω: " + skin.name);

        // –ü—Ä–∏–º–µ–Ω—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ
        applyActiveSkins();

        // –ê–Ω–∏–º–∞—Ü–∏—è
        gsap.from("#inventoryList", {opacity: 0.5, duration: 0.3});
    }

    // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫–∏–Ω–æ–≤
    function applyActiveSkins() {

        /* -----------------------------
           –°–ö–ò–ù –ù–ê –ú–ï–ù–Æ (—Ñ–æ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
        ------------------------------*/
        if (activeSkins.menu) {
            if (activeSkins.menu.name.includes("–ó–æ–ª–æ—Ç")) {
                document.body.style.background = "linear-gradient(135deg, #ffea00, #ffb300)";
            }
            else if (activeSkins.menu.name.includes("–ê–ª–º–∞–∑")) {
                document.body.style.background = "linear-gradient(135deg, #00eaff, #007bff)";
            }
            else if (activeSkins.menu.name.includes("–¢—ë–º–Ω") || activeSkins.menu.name.includes("–í–∞–º–ø–∏—Ä")) {
                document.body.style.background = "linear-gradient(135deg, #1a001f, #4b003b)";
            }
        }

        /* -----------------------------
           –°–ö–ò–ù –ù–ê –û–†–£–ñ–ò–ï (—Ä—É–ª–µ—Ç–∫–∞)
        ------------------------------*/
        const wheel = document.getElementById("rouletteWheel");

        if (wheel && activeSkins.weapon) {
            if (activeSkins.weapon.name.includes("–ó–æ–ª–æ—Ç")) {
                wheel.style.borderColor = "#ffd700";
                wheel.style.boxShadow = "0 0 20px #ffd700";
            }
            else if (activeSkins.weapon.name.includes("–ê–ª–º–∞–∑")) {
                wheel.style.borderColor = "#00eaff";
                wheel.style.boxShadow = "0 0 20px #00eaff";
            }
            else if (activeSkins.weapon.name.includes("–í–∞–º–ø–∏—Ä") || activeSkins.weapon.name.includes("–¢—ë–º–Ω")) {
                wheel.style.borderColor = "#8a0037";
                wheel.style.boxShadow = "0 0 20px #8a0037";
            }
        }

        /* -----------------------------
           –≠–§–§–ï–ö–¢–´ (–ø–æ–±–µ–¥–∞ –≤ –∏–≥—Ä–∞—Ö)
        ------------------------------*/
        if (activeSkins.effect) {
            if (activeSkins.effect.name.includes("–ó–æ–ª–æ—Ç")) {
                window.winEffect = () => {
                    gsap.from("body", {backgroundColor: "#ffd700", duration: 0.3});
                };
            }
            else if (activeSkins.effect.name.includes("–ê–ª–º–∞–∑")) {
                window.winEffect = () => {
                    gsap.from("body", {backgroundColor: "#00eaff", duration: 0.3});
                };
            }
            else if (activeSkins.effect.name.includes("–ö—Ä–æ–≤–∞–≤") || activeSkins.effect.name.includes("–¢—ë–º–Ω")) {
                window.winEffect = () => {
                    gsap.from("body", {backgroundColor: "#8a0037", duration: 0.3});
                };
            }
        }
    }

    // –í—ã–∑–æ–≤ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø–æ–±–µ–¥—ã (–±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –∏–≥—Ä–∞—Ö)
    function triggerWinEffect() {
        if (window.winEffect) window.winEffect();
    }
</script>
<!-- EFFECTS SYSTEM -->
<div id="screen-effects" class="screen p-4">

    <h1 class="text-3xl font-bold mb-4">–≠—Ñ—Ñ–µ–∫—Ç—ã</h1>

    <div id="effectsList" class="grid grid-cols-1 gap-4">
        <!-- –≠—Ñ—Ñ–µ–∫—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –∑–¥–µ—Å—å -->
    </div>

</div>

<script>
    let equippedEffect = null;

    const effects = [
        {
            name: "–ó–æ–ª–æ—Ç–æ–π —ç—Ñ—Ñ–µ–∫—Ç",
            id: "gold",
            color: "#ffd700",
            glow: "0 0 20px #ffd700",
            rarity: "legendary"
        },
        {
            name: "–ê–ª–º–∞–∑–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç",
            id: "diamond",
            color: "#7df9ff",
            glow: "0 0 20px #7df9ff",
            rarity: "epic"
        },
        {
            name: "–≠—Ñ—Ñ–µ–∫—Ç –¢—å–º—ã",
            id: "dark",
            color: "#8a2be2",
            glow: "0 0 25px #8a2be2",
            rarity: "rare"
        }
    ];

    function renderEffects() {
        const list = document.getElementById("effectsList");
        list.innerHTML = "";

        effects.forEach((effect, index) => {
            const div = document.createElement("div");

            let bg = "#ffffff10";
            if (effect.rarity === "legendary") bg = "#ffd70030";
            if (effect.rarity === "epic") bg = "#7df9ff30";
            if (effect.rarity === "rare") bg = "#8a2be230";

            div.className = "p-4 rounded-xl border border-white/10";
            div.style.background = bg;

            div.innerHTML = `
                <h2 class="text-xl font-semibold">${effect.name}</h2>
                <p class="opacity-70 text-sm mb-2">–†–µ–¥–∫–æ—Å—Ç—å: ${effect.rarity}</p>

                <button onclick="equipEffect(${index})"
                        class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg mt-2">
                    –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                </button>
            `;

            list.appendChild(div);
        });
    }

    function equipEffect(index) {
        const effect = effects[index];
        equippedEffect = effect;

        document.body.style.transition = "0.4s";
        document.body.style.boxShadow = effect.glow;
        document.body.style.background = `linear-gradient(135deg, #000000, ${effect.color}20)`;

        alert("–≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏–º–µ–Ω—ë–Ω: " + effect.name);

        gsap.from("body", {opacity: 0.7, duration: 0.3});
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–Ω–¥–µ—Ä –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
    function openScreen(name) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        document.querySelector(`#screen-${name}`).classList.add('active-screen');

        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');

        if (name === "effects") renderEffects();
    }
</script>
<!-- GLOBAL ANIMATIONS -->
<script>
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞
    function animateScreen(screenId) {
        const el = document.getElementById(screenId);
        gsap.from(el, {
            opacity: 0,
            y: 20,
            duration: 0.35,
            ease: "power2.out"
        });
    }

    // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º openScreen —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
    function openScreen(name) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        const target = document.querySelector(`#screen-${name}`);
        target.classList.add('active-screen');

        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');

        animateScreen(`screen-${name}`);

        if (name === "inventory") renderInventory();
        if (name === "effects") renderEffects();
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll("button").forEach(btn => {
            btn.addEventListener("mousedown", () => {
                gsap.to(btn, {scale: 0.92, duration: 0.1});
            });
            btn.addEventListener("mouseup", () => {
                gsap.to(btn, {scale: 1, duration: 0.1});
            });
        });
    });

    // –ê–Ω–∏–º–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    document.addEventListener("mouseover", e => {
        if (e.target.closest(".card-anim")) {
            gsap.to(e.target.closest(".card-anim"), {scale: 1.03, duration: 0.15});
        }
    });

    document.addEventListener("mouseout", e => {
        if (e.target.closest(".card-anim")) {
            gsap.to(e.target.closest(".card-anim"), {scale: 1, duration: 0.15});
        }
    });

    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–±–µ–¥—ã (–µ—Å–ª–∏ –Ω–µ—Ç —Å–∫–∏–Ω–∞)
    if (!window.winEffect) {
        window.winEffect = () => {
            gsap.from("body", {backgroundColor: "#ffffff20", duration: 0.3});
        };
    }
</script>
<!-- MINES GAME -->
<div id="screen-mines" class="screen p-4">

    <h1 class="text-3xl font-bold mb-4">–ú–∏–Ω—ã 3√ó3</h1>

    <div id="minesStatus" class="text-xl font-semibold mb-4">
        –•–æ–¥ –∏–≥—Ä–æ–∫–∞ 1
    </div>

    <div id="minesBoard" class="grid grid-cols-3 gap-3 w-64">
        <!-- –ö–ª–µ—Ç–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º -->
    </div>

</div>

<script>
    let minesBoard = Array(9).fill(null);
    let currentPlayer = 1;
    let gameOver = false;

    function initMines() {
        const board = document.getElementById("minesBoard");
        board.innerHTML = "";

        minesBoard = Array(9).fill(null);
        currentPlayer = 1;
        gameOver = false;

        document.getElementById("minesStatus").textContent = "–•–æ–¥ –∏–≥—Ä–æ–∫–∞ 1";

        for (let i = 0; i < 9; i++) {
            const cell = document.createElement("div");
            cell.className = "w-20 h-20 bg-white/10 border border-white/20 rounded-xl flex items-center justify-center text-3xl font-bold cursor-pointer";
            cell.dataset.index = i;

            cell.addEventListener("click", () => clickMines(i, cell));

            board.appendChild(cell);
        }

        gsap.from("#minesBoard", {opacity: 0, y: 20, duration: 0.3});
    }

    function clickMines(i, cell) {
        if (gameOver) return;
        if (minesBoard[i] !== null) return;

        minesBoard[i] = currentPlayer;

        cell.textContent = "üí£";
        cell.style.color = currentPlayer === 1 ? "#ff4444" : "#448aff";

        gsap.from(cell, {scale: 0.2, duration: 0.2});

        if (checkLose(currentPlayer)) {
            document.getElementById("minesStatus").textContent =
                `–ò–≥—Ä–æ–∫ ${currentPlayer} —Å–æ–±—Ä–∞–ª 3 –±–æ–º–±—ã ‚Äî –ø—Ä–æ–∏–≥—Ä–∞–ª`;

            gameOver = true;
            return;
        }

        currentPlayer = currentPlayer === 1 ? 2 : 1;
        document.getElementById("minesStatus").textContent = `–•–æ–¥ –∏–≥—Ä–æ–∫–∞ ${currentPlayer}`;
    }

    function checkLose(player) {
        const lines = [
            [0,1,2], [3,4,5], [6,7,8], // –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
            [0,3,6], [1,4,7], [2,5,8], // –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
            [0,4,8], [2,4,6]           // –¥–∏–∞–≥–æ–Ω–∞–ª–∏
        ];

        return lines.some(line =>
            line.every(index => minesBoard[index] === player)
        );
    }

    // –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —ç–∫—Ä–∞–Ω–∞
    function openScreen(name) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        const target = document.querySelector(`#screen-${name}`);
        target.classList.add('active-screen');

        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');

        if (name === "mines") initMines();
    }
</script>
<!-- UNIVERSAL GAME ANIMATIONS -->
<script>
    /* -----------------------------------------
       –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–∏–≥—Ä—ã—à–∞
    ------------------------------------------*/
    function gameWinFlash(color) {
        gsap.from("body", {
            backgroundColor: color,
            duration: 0.25,
            ease: "power2.out"
        });
    }

    /* -----------------------------------------
       Coin Flip ‚Äî –∞–Ω–∏–º–∞—Ü–∏—è –º–æ–Ω–µ—Ç–∫–∏
    ------------------------------------------*/
    function animateCoin(coinEl) {
        gsap.fromTo(coinEl,
            {rotationX: 0},
            {
                rotationX: 1080,
                duration: 1.2,
                ease: "power2.inOut"
            }
        );
    }

    /* -----------------------------------------
       Roulette ‚Äî –≤—Ä–∞—â–µ–Ω–∏–µ –∫–æ–ª–µ—Å–∞
    ------------------------------------------*/
    function spinRoulette(wheelEl, degrees) {
        gsap.to(wheelEl, {
            rotation: degrees,
            duration: 2.5,
            ease: "power4.out"
        });
    }

    /* -----------------------------------------
       RPS ‚Äî –ø–æ—è–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    ------------------------------------------*/
    function animateRPSResult(el) {
        gsap.from(el, {
            opacity: 0,
            scale: 0.6,
            duration: 0.25,
            ease: "back.out(1.7)"
        });
    }

    /* -----------------------------------------
       PVP ‚Äî —É–¥–∞—Ä / –ø–æ–ø–∞–¥–∞–Ω–∏–µ
    ------------------------------------------*/
    function pvpHitEffect(targetEl) {
        gsap.from(targetEl, {
            x: -15,
            duration: 0.1,
            repeat: 3,
            yoyo: true
        });
    }

    /* -----------------------------------------
       Mines ‚Äî –≤–∑—Ä—ã–≤ –∫–ª–µ—Ç–∫–∏
    ------------------------------------------*/
    function minesExplosion(cell) {
        gsap.from(cell, {
            scale: 1.4,
            backgroundColor: "#ff0000",
            duration: 0.25,
            ease: "power2.out"
        });
    }

    /* -----------------------------------------
       –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    ------------------------------------------*/
    function popIn(el) {
        gsap.from(el, {
            opacity: 0,
            scale: 0.85,
            duration: 0.25,
            ease: "power2.out"
        });
    }

    /* -----------------------------------------
       –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫
    ------------------------------------------*/
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll("button").forEach(btn => {
            btn.addEventListener("mousedown", () => {
                gsap.to(btn, {scale: 0.92, duration: 0.1});
            });
            btn.addEventListener("mouseup", () => {
                gsap.to(btn, {scale: 1, duration: 0.1});
            });
        });
    });
</script>
<!-- GLOBAL SOUND SYSTEM -->
<audio id="sound-click" src="https://cdn.jsdelivr.net/gh/naptha/tiny-sfx/click1.mp3"></audio>
<audio id="sound-win" src="https://cdn.jsdelivr.net/gh/naptha/tiny-sfx/confirm1.mp3"></audio>
<audio id="sound-lose" src="https://cdn.jsdelivr.net/gh/naptha/tiny-sfx/error1.mp3"></audio>
<audio id="sound-bomb" src="https://cdn.jsdelivr.net/gh/naptha/tiny-sfx/explosion1.mp3"></audio>
<audio id="sound-coin" src="https://cdn.jsdelivr.net/gh/naptha/tiny-sfx/coin1.mp3"></audio>
<audio id="sound-spin" src="https://cdn.jsdelivr.net/gh/naptha/tiny-sfx/whoosh1.mp3"></audio>

<script>
    function playSound(id) {
        const el = document.getElementById(id);
        if (!el) return;
        el.currentTime = 0;
        el.play();
    }

    /* -----------------------------
       –ö–ª–∏–∫–∏ –ø–æ –∫–Ω–æ–ø–∫–∞–º
    ------------------------------*/
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll("button").forEach(btn => {
            btn.addEventListener("click", () => playSound("sound-click"));
        });
    });

    /* -----------------------------
       –ü–æ–±–µ–¥–∞
    ------------------------------*/
    function soundWin() {
        playSound("sound-win");
    }

    /* -----------------------------
       –ü–æ—Ä–∞–∂–µ–Ω–∏–µ
    ------------------------------*/
    function soundLose() {
        playSound("sound-lose");
    }

    /* -----------------------------
       –ú–æ–Ω–µ—Ç–∫–∞ (Coin Flip)
    ------------------------------*/
    function soundCoin() {
        playSound("sound-coin");
    }

    /* -----------------------------
       –†—É–ª–µ—Ç–∫–∞ (Roulette)
    ------------------------------*/
    function soundSpin() {
        playSound("sound-spin");
    }

    /* -----------------------------
       –ë–æ–º–±–∞ (–ú–∏–Ω—ã, PvP, —ç—Ñ—Ñ–µ–∫—Ç—ã)
    ------------------------------*/
    function soundBomb() {
        playSound("sound-bomb");
    }
</script>
<!-- PLAYER PROFILE -->
<div id="screen-profile" class="screen p-4">

    <h1 class="text-3xl font-bold mb-4">–ü—Ä–æ—Ñ–∏–ª—å</h1>

    <div class="p-4 bg-white/10 border border-white/20 rounded-2xl w-full max-w-md">

        <!-- –ê–≤–∞—Ç–∞—Ä -->
        <div class="flex items-center gap-4 mb-4">
            <div id="profileAvatar"
                 class="w-20 h-20 rounded-full bg-white/20 border border-white/30 flex items-center justify-center text-4xl">
                üòé
            </div>

            <div>
                <div class="text-xl font-bold" id="profileName">–ò–≥—Ä–æ–∫</div>
                <div class="opacity-70 text-sm">–£—Ä–æ–≤–µ–Ω—å: <span id="profileLevel">1</span></div>
            </div>
        </div>

        <!-- –ë–∞–ª–∞–Ω—Å -->
        <div class="mb-4">
            <div class="text-lg font-semibold">–ë–∞–ª–∞–Ω—Å</div>
            <div id="profileBalance" class="text-2xl font-bold text-yellow-300">0</div>
        </div>

        <!-- –û–ø—ã—Ç -->
        <div class="mb-4">
            <div class="text-lg font-semibold">–û–ø—ã—Ç</div>
            <div class="w-full bg-white/10 h-4 rounded-full overflow-hidden">
                <div id="profileXPBar" class="h-full bg-green-500" style="width: 0%"></div>
            </div>
            <div class="text-sm opacity-70 mt-1">
                <span id="profileXP">0</span> / <span id="profileXPMax">100</span>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="mb-4">
            <div class="text-lg font-semibold mb-2">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>

            <div class="opacity-80 text-sm">
                –ü–æ–±–µ–¥: <span id="statWins">0</span><br>
                –ü–æ—Ä–∞–∂–µ–Ω–∏–π: <span id="statLosses">0</span><br>
                –ò–≥—Ä —Å—ã–≥—Ä–∞–Ω–æ: <span id="statGames">0</span>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ —Å–º–µ–Ω—ã –∞–≤–∞—Ç–∞—Ä–∞ -->
        <button onclick="changeAvatar()"
                class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg w-full">
            –°–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
        </button>

    </div>

</div>

<script>
    let player = {
        name: "–ò–≥—Ä–æ–∫",
        balance: 5000,
        level: 1,
        xp: 0,
        xpMax: 100,
        wins: 0,
        losses: 0,
        games: 0,
        avatarIndex: 0,
        avatars: ["üòé", "üî•", "üëë", "üíÄ", "üßõ", "ü§ñ", "üêâ"]
    };

    function renderProfile() {
        document.getElementById("profileName").textContent = player.name;
        document.getElementById("profileBalance").textContent = player.balance;

        document.getElementById("profileLevel").textContent = player.level;
        document.getElementById("profileXP").textContent = player.xp;
        document.getElementById("profileXPMax").textContent = player.xpMax;

        const percent = (player.xp / player.xpMax) * 100;
        document.getElementById("profileXPBar").style.width = percent + "%";

        document.getElementById("statWins").textContent = player.wins;
        document.getElementById("statLosses").textContent = player.losses;
        document.getElementById("statGames").textContent = player.games;

        document.getElementById("profileAvatar").textContent =
            player.avatars[player.avatarIndex];

        gsap.from("#screen-profile", {opacity: 0, y: 20, duration: 0.3});
    }

    function addXP(amount) {
        player.xp += amount;

        if (player.xp >= player.xpMax) {
            player.xp -= player.xpMax;
            player.level++;
            player.xpMax = Math.floor(player.xpMax * 1.25);

            gsap.from("#profileLevel", {scale: 1.4, duration: 0.3});
        }

        renderProfile();
    }

    function addWin() {
        player.wins++;
        player.games++;
        addXP(20);
    }

    function addLoss() {
        player.losses++;
        player.games++;
        addXP(5);
    }

    function changeAvatar() {
        player.avatarIndex++;
        if (player.avatarIndex >= player.avatars.length) player.avatarIndex = 0;

        renderProfile();

        gsap.from("#profileAvatar", {scale: 0.6, duration: 0.2});
    }

    function openScreen(name) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        const target = document.querySelector(`#screen-${name}`);
        target.classList.add('active-screen');

        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');

        if (name === "profile") renderProfile();
    }
</script>
<!-- SAVE SYSTEM -->
<script>
    /* -----------------------------------------
       –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
    ------------------------------------------*/
    function saveGame() {
        const data = {
            player,
            inventory,
            activeSkins,
            equippedEffect
        };

        localStorage.setItem("gameData", JSON.stringify(data));
    }

    /* -----------------------------------------
       –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    ------------------------------------------*/
    function loadGame() {
        const raw = localStorage.getItem("gameData");
        if (!raw) return;

        try {
            const data = JSON.parse(raw);

            if (data.player) player = data.player;
            if (data.inventory) inventory = data.inventory;
            if (data.activeSkins) activeSkins = data.activeSkins;
            if (data.equippedEffect) equippedEffect = data.equippedEffect;

            applyActiveSkins();
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π:", e);
        }
    }

    /* -----------------------------------------
       –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
    ------------------------------------------*/
    setInterval(saveGame, 5000);

    /* -----------------------------------------
       –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏
    ------------------------------------------*/
    window.addEventListener("beforeunload", saveGame);

    /* -----------------------------------------
       –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    ------------------------------------------*/
    document.addEventListener("DOMContentLoaded", () => {
        loadGame();
    });
</script>
<!-- GLOBAL NOTIFICATION SYSTEM -->
<style>
    #notifyContainer {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 260px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        z-index: 9999;
    }

    .notify {
        padding: 12px 16px;
        border-radius: 12px;
        color: white;
        font-weight: 600;
        backdrop-filter: blur(6px);
        border: 1px solid rgba(255,255,255,0.2);
        opacity: 0;
    }
</style>

<div id="notifyContainer"></div>

<script>
    function notify(text, type = "info") {
        const box = document.createElement("div");
        box.className = "notify";

        if (type === "info") box.style.background = "rgba(0,150,255,0.35)";
        if (type === "success") box.style.background = "rgba(0,255,120,0.35)";
        if (type === "error") box.style.background = "rgba(255,0,80,0.35)";
        if (type === "warning") box.style.background = "rgba(255,180,0,0.35)";

        box.textContent = text;

        document.getElementById("notifyContainer").appendChild(box);

        gsap.to(box, {opacity: 1, x: 0, duration: 0.3, ease: "power2.out"});
        gsap.from(box, {x: 40, duration: 0.3, ease: "power2.out"});

        setTimeout(() => {
            gsap.to(box, {
                opacity: 0,
                x: 40,
                duration: 0.3,
                ease: "power2.in",
                onComplete: () => box.remove()
            });
        }, 2500);
    }

    // –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
    // notify("–ü–æ–±–µ–¥–∞!", "success");
    // notify("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç", "error");
    // notify("–°–∫–∏–Ω –ø—Ä–∏–º–µ–Ω—ë–Ω", "info");
    // notify("–û—Å—Ç–æ—Ä–æ–∂–Ω–æ!", "warning");
</script>
<!-- GLOBAL NAVIGATION BAR -->
<style>
    #navBar {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px;
        background: rgba(0,0,0,0.55);
        backdrop-filter: blur(12px);
        border-top: 1px solid rgba(255,255,255,0.15);
        display: flex;
        justify-content: space-around;
        align-items: center;
        z-index: 999;
    }

    .nav-item {
        color: white;
        opacity: 0.6;
        font-size: 26px;
        transition: 0.25s;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
    }

    .nav-item.active {
        opacity: 1;
        transform: translateY(-6px);
        text-shadow: 0 0 12px rgba(255,255,255,0.6);
    }

    .nav-label {
        font-size: 11px;
        opacity: 0.8;
    }
</style>

<div id="navBar">
    <div class="nav-item" data-screen="profile">
        <div>üë§</div>
        <div class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
    </div>

    <div class="nav-item" data-screen="inventory">
        <div>üéí</div>
        <div class="nav-label">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
    </div>

    <div class="nav-item" data-screen="market">
        <div>üõí</div>
        <div class="nav-label">–ú–∞–≥–∞–∑–∏–Ω</div>
    </div>

    <div class="nav-item" data-screen="games">
        <div>üéÆ</div>
        <div class="nav-label">–ò–≥—Ä—ã</div>
    </div>

    <div class="nav-item" data-screen="effects">
        <div>‚ú®</div>
        <div class="nav-label">–≠—Ñ—Ñ–µ–∫—Ç—ã</div>
    </div>
</div>

<script>
    // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º openScreen –ø–æ–¥ –Ω–æ–≤–æ–µ –º–µ–Ω—é
    function openScreen(name) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        const target = document.querySelector(`#screen-${name}`);
        target.classList.add('active-screen');

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
            if (item.dataset.screen === name) item.classList.add('active');
        });

        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
        gsap.from(target, {opacity: 0, y: 20, duration: 0.3});

        // –†–µ–Ω–¥–µ—Ä—ã
        if (name === "inventory") renderInventory();
        if (name === "effects") renderEffects();
        if (name === "profile") renderProfile();
        if (name === "mines") initMines();
    }

    // –ö–ª–∏–∫–∏ –ø–æ –º–µ–Ω—é
    document.querySelectorAll(".nav-item").forEach(item => {
        item.addEventListener("click", () => {
            openScreen(item.dataset.screen);
        });
    });
</script>
<!-- GLOBAL UI ENHANCER -->
<style>
    /* –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–æ–Ω */
    body {
        background: radial-gradient(circle at center, #0a0a0a, #000000);
        color: white;
        font-family: "Inter", sans-serif;
        transition: background 0.4s ease;
    }

    /* –í—Å–µ —ç–∫—Ä–∞–Ω—ã */
    .screen {
        display: none;
        padding-bottom: 100px;
        min-height: calc(100vh - 100px);
        animation: fadeIn 0.35s ease;
    }

    .active-screen {
        display: block;
    }

    /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
    .card {
        background: rgba(255,255,255,0.06);
        border: 1px solid rgba(255,255,255,0.12);
        border-radius: 16px;
        padding: 16px;
        backdrop-filter: blur(8px);
        transition: 0.25s;
    }

    .card:hover {
        transform: translateY(-4px);
        box-shadow: 0 0 18px rgba(255,255,255,0.15);
    }

    /* –ö–Ω–æ–ø–∫–∏ */
    button {
        background: linear-gradient(135deg, #1f1f1f, #2a2a2a);
        border: 1px solid rgba(255,255,255,0.15);
        padding: 10px 16px;
        border-radius: 12px;
        color: white;
        font-weight: 600;
        transition: 0.2s;
    }

    button:hover {
        background: linear-gradient(135deg, #2a2a2a, #3a3a3a);
        box-shadow: 0 0 12px rgba(255,255,255,0.2);
    }

    /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ */
    h1, h2, h3 {
        text-shadow: 0 0 12px rgba(255,255,255,0.25);
    }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to   { opacity: 1; transform: translateY(0); }
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 480px) {
        #navBar {
            height: 65px;
        }
        .nav-item {
            font-size: 22px;
        }
        .screen {
            padding: 12px;
        }
    }
</style>

<script>
    /* –ì–ª–æ–±–∞–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
    function smoothAppear(el) {
        gsap.from(el, {
            opacity: 0,
            y: 20,
            duration: 0.35,
            ease: "power2.out"
        });
    } 

    /* –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ openScreen –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ */
    const oldOpenScreen = openScreen;

    openScreen = function(name) {
        oldOpenScreen(name);
        const target = document.querySelector(`#screen-${name}`);
        smoothAppear(target);
    };
</script>
<!-- JACKPOT ROULETTE ONLINE (FIREBASE) -->
<div id="screen-jackpot" class="screen p-4">
    <h1 class="text-3xl font-bold mb-4">Jackpot Roulette</h1>

    <div class="max-w-md card mx-auto">
        <div class="mb-3">
            <div class="text-sm opacity-70">–¢–≤–æ–π –±–∞–ª–∞–Ω—Å (Stars)</div>
            <div id="jackpotBalance" class="text-2xl font-bold">0</div>
        </div>

        <div class="mb-3">
            <div class="text-sm opacity-70">–¢–µ–∫—É—â–∏–π –±–∞–Ω–∫</div>
            <div id="jackpotTotal" class="text-2xl font-bold text-yellow-300">0</div>
        </div>

        <div class="mb-3">
            <label class="text-sm opacity-80">–°—Ç–∞–≤–∫–∞ (25‚Äì100000 Stars)</label>
            <input id="jackpotBetInput"
                   type="number"
                   min="25"
                   max="100000"
                   class="w-full mt-1 px-3 py-2 rounded-lg bg-black/40 border border-white/20 outline-none"
                   placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É">
        </div>

        <button id="jackpotBetBtn" class="w-full mb-3">
            –°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É
        </button>

        <button id="jackpotStartBtn" class="w-full bg-green-600 hover:bg-green-700">
            –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—É–Ω–¥
        </button>

        <div id="jackpotStatus" class="mt-3 text-sm opacity-80"></div>

        <div class="mt-4">
            <div class="text-sm opacity-70 mb-1">–£—á–∞—Å—Ç–Ω–∏–∫–∏ (–º–∞–∫—Å. 8)</div>
            <div id="jackpotPlayers" class="space-y-2 text-sm"></div>
        </div>
    </div>
</div>

<script type="module">
    // ====== –ù–ê–°–¢–†–û–ô–ö–ê FIREBASE (–ó–ê–ú–ï–ù–ò –ö–û–ù–§–ò–ì –ù–ê –°–í–û–ô) ======
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import {
        getDatabase,
        ref,
        onValue,
        set,
        update,
        get,
        child,
        remove
    } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "SENDER_ID",
        appId: "APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // ====== –õ–û–ö–ê–õ–¨–ù–´–ô –ò–ì–†–û–ö (–ü–û–¢–û–ú –ó–ê–ú–ï–ù–ò–ú –ù–ê TELEGRAM) ======
    // player —É–∂–µ –µ—Å—Ç—å —É —Ç–µ–±—è –≤ –ø—Ä–æ–µ–∫—Ç–µ, –∑–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
    const localPlayer = {
        id: "p_" + Math.random().toString(36).slice(2),
        name: (window.player && player.name) || "–ò–≥—Ä–æ–∫",
        avatar: (window.player && player.avatars && player.avatars[player.avatarIndex || 0]) || "üòé",
        balance: (window.player && player.balance) || 0
    };

    const jackpotRootRef = ref(db, "jackpot");
    const roundRef = ref(db, "jackpot/currentRound");
    const betsRef = ref(db, "jackpot/currentRound/bets");
    const resultRef = ref(db, "jackpot/currentRound/result");

    const elBalance = document.getElementById("jackpotBalance");
    const elTotal = document.getElementById("jackpotTotal");
    const elBetInput = document.getElementById("jackpotBetInput");
    const elBetBtn = document.getElementById("jackpotBetBtn");
    const elStartBtn = document.getElementById("jackpotStartBtn");
    const elStatus = document.getElementById("jackpotStatus");
    const elPlayers = document.getElementById("jackpotPlayers");

    let currentBets = {};
    let totalBank = 0;

    function renderLocalBalance() {
        elBalance.textContent = localPlayer.balance;
    }

    function renderBets() {
        elPlayers.innerHTML = "";
        totalBank = 0;

        const entries = Object.values(currentBets);
        entries.forEach(b => totalBank += b.amount);

        elTotal.textContent = totalBank;

        entries.forEach(b => {
            const chance = totalBank > 0 ? ((b.amount / totalBank) * 100).toFixed(1) : 0;
            const row = document.createElement("div");
            row.className = "flex items-center justify-between bg-white/5 rounded-lg px-3 py-2";

            row.innerHTML = `
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center text-lg">
                        ${b.avatar || "üòé"}
                    </div>
                    <div>
                        <div class="font-semibold">${b.name}</div>
                        <div class="text-xs opacity-70">${b.amount} Stars</div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-xs opacity-70">–®–∞–Ω—Å</div>
                    <div class="font-semibold">${chance}%</div>
                </div>
            `;
            elPlayers.appendChild(row);
        });
    }

    // –°–ª—É—à–∞–µ–º —Å—Ç–∞–≤–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
    onValue(betsRef, snap => {
        const val = snap.val() || {};
        currentBets = val;
        renderBets();
    });

    // –°–ª—É—à–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—É–Ω–¥–∞
    onValue(resultRef, snap => {
        const res = snap.val();
        if (!res) return;

        const winnerId = res.winnerId;
        const winnerBet = currentBets[winnerId];
        if (!winnerBet) return;

        const msg = `–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: ${winnerBet.name} (${winnerBet.amount} Stars) –∑–∞–±–∏—Ä–∞–µ—Ç –±–∞–Ω–∫ ${res.total} Stars`;
        elStatus.textContent = msg;
        if (winnerId === localPlayer.id) {
            notify && notify("–¢—ã –≤—ã–∏–≥—Ä–∞–ª –¥–∂–µ–∫–ø–æ—Ç!", "success");
            localPlayer.balance += res.total;
            if (window.player) player.balance = localPlayer.balance;
            renderLocalBalance();
        } else {
            notify && notify(msg, "info");
        }
    });

    // –°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É
    elBetBtn.addEventListener("click", async () => {
        const raw = elBetInput.value.trim();
        const amount = parseInt(raw, 10);

        if (isNaN(amount)) {
            elStatus.textContent = "–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É —Å—Ç–∞–≤–∫–∏";
            return;
        }
        if (amount < 25) {
            elStatus.textContent = "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ 25 Stars";
            return;
        }
        if (amount > 100000) {
            elStatus.textContent = "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ 100000 Stars";
            return;
        }
        if (amount > localPlayer.balance) {
            elStatus.textContent = "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ Stars";
            notify && notify("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ Stars", "error");
            return;
        }

        // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 8 –∏–≥—Ä–æ–∫–æ–≤
        const snap = await get(betsRef);
        const bets = snap.val() || {};
        const uniquePlayers = Object.keys(bets);
        if (!bets[localPlayer.id] && uniquePlayers.length >= 8) {
            elStatus.textContent = "–ú–∞–∫—Å–∏–º—É–º 8 –∏–≥—Ä–æ–∫–æ–≤ –≤ —Ä–∞—É–Ω–¥–µ";
            return;
        }

        const betData = {
            playerId: localPlayer.id,
            name: localPlayer.name,
            avatar: localPlayer.avatar,
            amount
        };

        await set(child(betsRef, localPlayer.id), betData);

        localPlayer.balance -= amount;
        if (window.player) player.balance = localPlayer.balance;
        renderLocalBalance();

        elStatus.textContent = "–°—Ç–∞–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞";
        elBetInput.value = "";
    });

    // –ó–∞–ø—É—Å–∫ —Ä–∞—É–Ω–¥–∞ (–ª—é–±–æ–π –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –Ω–∞–∂–∞—Ç—å)
    elStartBtn.addEventListener("click", async () => {
        const snap = await get(betsRef);
        const bets = snap.val() || {};
        const entries = Object.values(bets);

        if (entries.length === 0) {
            elStatus.textContent = "–ù–µ—Ç —Å—Ç–∞–≤–æ–∫ –¥–ª—è —Ä–∞—É–Ω–¥–∞";
            return;
        }

        let total = 0;
        entries.forEach(b => total += b.amount);

        let roll = Math.random() * total;
        let winner = null;

        for (const b of entries) {
            if (roll < b.amount) {
                winner = b;
                break;
            }
            roll -= b.amount;
        }

        if (!winner) {
            elStatus.textContent = "–û—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è";
            return;
        }

        await set(resultRef, {
            winnerId: winner.playerId,
            total,
            ts: Date.now()
        });

        // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞–≤–æ–∫ –ø–æ—Å–ª–µ —Ä–∞—É–Ω–¥–∞
        await remove(betsRef);
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
    renderLocalBalance();

    // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ –≤ —Ç–≤–æ—é —Å–∏—Å—Ç–µ–º—É
    if (typeof openScreen === "function") {
        // –ø—Ä–æ—Å—Ç–æ —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ —ç–∫—Ä–∞–Ω –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å
        // openScreen("jackpot"); // –≤–∫–ª—é—á–∏—à—å —Å–∞–º, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ
    }
</script>
<script type="module">
    // ====== TELEGRAM MINI APP INIT ======
    const tg = window.Telegram.WebApp;
    tg.expand(); // —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

    // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
    const tgUser = tg.initDataUnsafe?.user;

    if (!tgUser) {
        alert("–û—à–∏–±–∫–∞: Telegram WebApp –Ω–µ –ø–µ—Ä–µ–¥–∞–ª –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.");
    }

    // –õ–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞
    const localPlayer = {
        id: "tg_" + tgUser.id,
        name: tgUser.first_name || "–ò–≥—Ä–æ–∫",
        username: tgUser.username || null,
        avatarUrl: null, // –∑–∞–≥—Ä—É–∑–∏–º –Ω–∏–∂–µ
        balance: 0 // –ø–æ–∫–∞ 0, –≤ –ß–∞—Å—Ç—å 23 –ø–æ–¥–∫–ª—é—á–∏–º Stars
    };

    // ====== –ó–ê–ì–†–£–ó–ö–ê –ê–í–ê–¢–ê–†–ö–ò –ò–ó TELEGRAM ======
    async function loadTelegramAvatar() {
        try {
            const response = await fetch(
                `https://api.telegram.org/bot${BOT_TOKEN}/getUserProfilePhotos?user_id=${tgUser.id}&limit=1`
            );
            const data = await response.json();

            if (data.ok && data.result.total_count > 0) {
                const fileId = data.result.photos[0][0].file_id;

                const fileResp = await fetch(
                    `https://api.telegram.org/bot${BOT_TOKEN}/getFile?file_id=${fileId}`
                );
                const fileData = await fileResp.json();

                if (fileData.ok) {
                    localPlayer.avatarUrl =
                        `https://api.telegram.org/file/bot${BOT_TOKEN}/${fileData.result.file_path}`;
                }
            }
        } catch (e) {
            console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä–∫—É Telegram:", e);
        }
    }

    await loadTelegramAvatar();

    // ====== FIREBASE INIT ======
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import {
        getDatabase,
        ref,
        get,
        set,
        update
    } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "SENDER_ID",
        appId: "APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // ====== –°–û–ó–î–ê–ù–ò–ï / –ó–ê–ì–†–£–ó–ö–ê –ü–†–û–§–ò–õ–Ø –ò–ì–†–û–ö–ê ======
    const playerRef = ref(db, "players/" + localPlayer.id);

    async function loadOrCreatePlayer() {
        const snap = await get(playerRef);

        if (snap.exists()) {
            const data = snap.val();
            localPlayer.balance = data.balance || 0;
            localPlayer.avatarUrl = data.avatarUrl || localPlayer.avatarUrl;
        } else {
            await set(playerRef, {
                id: localPlayer.id,
                name: localPlayer.name,
                username: localPlayer.username,
                avatarUrl: localPlayer.avatarUrl,
                balance: 0 // —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –±–∞–ª–∞–Ω—Å
            });
        }
    }

    await loadOrCreatePlayer();

    // ====== –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø –° –ò–ì–†–û–ô ======
    window.player = {
        id: localPlayer.id,
        name: localPlayer.name,
        avatar: localPlayer.avatarUrl,
        balance: localPlayer.balance
    };

    console.log("Telegram Mini App –≥–æ—Ç–æ–≤:", window.player);
</script>
<script type="module">
    import {
        getDatabase,
        ref,
        get,
        update,
        runTransaction
    } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    const db = getDatabase();

    // ====== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ë–ê–õ–ê–ù–°–ê LOCALLY ======
    function updateLocalBalance(newBalance) {
        window.player.balance = newBalance;
        const el = document.getElementById("jackpotBalance");
        if (el) el.textContent = newBalance;
    }

    // ====== –ü–û–õ–£–ß–ò–¢–¨ –ë–ê–õ–ê–ù–° –ò–ì–†–û–ö–ê ======
    async function getStarsBalance() {
        const snap = await get(ref(db, "players/" + player.id + "/balance"));
        return snap.exists() ? snap.val() : 0;
    }

    // ====== –°–ü–ò–°–ê–ù–ò–ï STARS ======
    async function spendStars(amount) {
        const playerRef = ref(db, "players/" + player.id + "/balance");

        return runTransaction(playerRef, balance => {
            if (balance === null) balance = 0;
            if (balance < amount) return; // –æ—Ç–º–µ–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
            return balance - amount;
        }).then(result => {
            if (!result.committed) {
                notify && notify("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ Stars", "error");
                return false;
            }
            updateLocalBalance(result.snapshot.val());
            return true;
        });
    }

    // ====== –ù–ê–ß–ò–°–õ–ï–ù–ò–ï STARS ======
    async function addStars(amount) {
        const playerRef = ref(db, "players/" + player.id + "/balance");

        return runTransaction(playerRef, balance => {
            if (balance === null) balance = 0;
            return balance + amount;
        }).then(result => {
            updateLocalBalance(result.snapshot.val());
            return true;
        });
    }

    // ====== –ü–û–ö–£–ü–ö–ê STARS –ß–ï–†–ï–ó TELEGRAM ======
    window.buyStars = function(amount) {
        Telegram.WebApp.openInvoice({
            title: "–ü–æ–∫—É–ø–∫–∞ Stars",
            description: `–ü–∞–∫–µ—Ç ${amount} Stars`,
            payload: "stars_purchase_" + amount,
            currency: "XTR", // Stars
            prices: [{ label: `${amount} Stars`, amount: amount }]
        }, async function(status) {
            if (status === "paid") {
                await addStars(amount);
                notify && notify(`–ù–∞—á–∏—Å–ª–µ–Ω–æ ${amount} Stars`, "success");
            } else {
                notify && notify("–ü–ª–∞—Ç—ë–∂ –æ—Ç–º–µ–Ω—ë–Ω", "error");
            }
        });
    };

    // ====== –ü–†–ò–ú–ï–† –ö–ù–û–ü–û–ö –ü–û–ö–£–ü–ö–ò ======
    window.renderStarsShop = function() {
        const shop = document.getElementById("starsShop");
        if (!shop) return;

        shop.innerHTML = `
            <button onclick="buyStars(100)">–ö—É–ø–∏—Ç—å 100 Stars</button>
            <button onclick="buyStars(500)">–ö—É–ø–∏—Ç—å 500 Stars</button>
            <button onclick="buyStars(1000)">–ö—É–ø–∏—Ç—å 1000 Stars</button>
        `;
    };

    // ====== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ======
    (async () => {
        const balance = await getStarsBalance();
        updateLocalBalance(balance);
    })();
</script>
