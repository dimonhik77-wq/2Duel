<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2Duels Tactical</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #0a0a0b;
            --card: rgba(28, 28, 32, 0.8);
            --accent: #00f2ff;
            --pink: #ff007a;
            --text: #ffffff;
            --dim: #88888b;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); overflow: hidden; height: 100vh; }
        
        /* –≠–∫—Ä–∞–Ω—ã */
        .screen { display: none; padding: 60px 20px 100px; height: 100vh; overflow-y: auto; }
        .screen.active { display: block; }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è –∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω–∞—Ö */
        .nav-bar {
            position: fixed; bottom: 0; width: 100%; height: 75px;
            background: rgba(15, 15, 18, 0.98); backdrop-filter: blur(15px);
            display: flex; justify-content: space-around; align-items: center;
            border-top: 1px solid rgba(255,255,255,0.05); z-index: 1000;
        }
        .nav-btn { display: flex; flex-direction: column; align-items: center; color: var(--dim); font-size: 11px; transition: 0.3s; }
        .nav-btn.active { color: var(--accent); }
        .nav-icon { font-size: 22px; margin-bottom: 4px; }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –∏–≥—Ä –°–æ–ª–æ */
        .game-banner {
            background: var(--card); border-radius: 20px; padding: 25px;
            margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;
            border: 1px solid rgba(255,255,255,0.03); position: relative; overflow: hidden;
        }
        .game-info h3 { font-size: 20px; margin-bottom: 5px; }
        .game-info p { font-size: 12px; color: var(--dim); }

        /* –ë–∞–ª–∞–Ω—Å –∏ —Ö–µ–¥–µ—Ä */
        header { position: fixed; top: 0; width: 100%; padding: 15px 20px; display: flex; justify-content: space-between; background: var(--bg); z-index: 1000; }
        .online-tag { color: #44ff44; font-size: 12px; display: flex; align-items: center; gap: 5px; }
        .online-dot { width: 6px; height: 6px; background: #44ff44; border-radius: 50%; box-shadow: 0 0 10px #44ff44; }
    </style>
</head>
<body>

<header>
    <div onclick="window.Telegram.WebApp.close()">‚úï –ó–∞–∫—Ä—ã—Ç—å</div>
    <div class="online-tag"><span class="online-dot"></span> 227 –æ–Ω–ª–∞–π–Ω</div>
    <div>‚ãÆ</div>
</header>

<div id="pvp" class="screen active">
    <div id="wheel-container" style="text-align:center;">
        </div>
</div>

<div id="solo" class="screen">
    <div class="game-banner">
        <div class="game-info"><h3>–û—Ä–µ–ª –∏ –†–µ—à–∫–∞</h3><p>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –¥—É—ç–ª—å 50/50</p></div>
        <div class="game-icon">ü™ô</div>
    </div>
    <div class="game-banner">
        <div class="game-info"><h3>–†—É—Å—Å–∫–∞—è –†—É–ª–µ—Ç–∫–∞</h3><p>–û–¥–∏–Ω —à–∞–Ω—Å –∏–∑ —à–µ—Å—Ç–∏</p></div>
        <div class="game-icon">üî´</div>
    </div>
    <div class="game-banner">
        <div class="game-info"><h3>–ö–ù–ë</h3><p>–ö–∞–º–µ–Ω—å, –ù–æ–∂–Ω–∏—Ü—ã, –ë—É–º–∞–≥–∞</p></div>
        <div class="game-icon">‚úåÔ∏è</div>
    </div>
    <div class="game-banner">
        <div class="game-info"><h3>–ß–∏–ø—Å—ã</h3><p>–ú–∏–Ω–Ω–æ–µ –ø–æ–ª–µ 3—Ö3</p></div>
        <div class="game-icon">üí£</div>
    </div>
</div>

<nav class="nav-bar">
    <div class="nav-btn active" onclick="setScreen('pvp', this)">
        <span class="nav-icon">‚öîÔ∏è</span><span>–ü–≤–ü</span>
    </div>
    <div class="nav-btn" onclick="setScreen('solo', this)">
        <span class="nav-icon">üéØ</span><span>–°–æ–ª–æ</span>
    </div>
    <div class="nav-btn">
        <span class="nav-icon">üéÅ</span><span>–†–æ–∑—ã–≥—Ä—ã—à–∏</span>
    </div>
    <div class="nav-btn" onclick="setScreen('profile', this)">
        <span class="nav-icon">üë§</span><span>–ü—Ä–æ—Ñ–∏–ª—å</span>
    </div>
</nav>

<script>
    function setScreen(id, el) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
    }
</script>
// --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø FIREBASE (–¢–í–û–ô –ö–û–ù–§–ò–ì) ---
const firebaseConfig = {
    apiKey: "AIzaSyBu4aaNbvARCtvRE1SGsNpkHRYAm3NK_I0",
    authDomain: "duels-1fb6b.firebaseapp.com",
    databaseURL: "https://duels-1fb6b-default-rtdb.firebaseio.com",
    projectId: "duels-1fb6b",
    storageBucket: "duels-1fb6b.firebasestorage.app",
    messagingSenderId: "745698956226",
    appId: "1:745698956226:web:27cd811a6633946e85fc5b",
    measurementId: "G-3BS344MXBP"
};

// --- –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê PVP –†–£–õ–ï–¢–ö–ò (8 –ò–ì–†–û–ö–û–í) ---
const wheelContainer = document.getElementById('wheel-container');
wheelContainer.innerHTML = `
    <div style="position:relative; width:320px; margin:0 auto;">
        <div id="wheel-timer" style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); 
             width:80px; height:80px; background:#000; border-radius:50%; display:flex; 
             align-items:center; justify-content:center; font-weight:bold; z-index:5;">00:00</div>
        <canvas id="wheelCanvas" width="600" height="600" style="width:100%; height:auto; border-radius:50%; transition: transform 5s cubic-bezier(0.15, 0, 0.15, 1);"></canvas>
        <div style="position:absolute; top:-10px; left:50%; transform:translateX(-50%); width:0; height:0; border-left:15px solid transparent; border-right:15px solid transparent; border-top:25px solid #fff; z-index:10;"></div>
    </div>
    <div id="wheel-info" style="margin-top:20px; font-size:14px; color:var(--dim);">–í–°–ï–ì–û: <span id="total-bank" style="color:var(--accent)">0.00 TON</span></div>
`;

const canvas = document.getElementById('wheelCanvas');
const ctx = canvas.getContext('2d');
let players = [
    { name: "@Magikmoney", bet: 1.15, color: "#ff007a", avatar: "üêµ" },
    { name: "@giftgambler", bet: 1.52, color: "#7a00ff", avatar: "üë§" },
    { name: "@x_player", bet: 0.5, color: "#00f2ff", avatar: "‚≠êÔ∏è" }
];

function drawWheel() {
    const total = players.reduce((sum, p) => sum + p.bet, 0);
    document.getElementById('total-bank').innerText = total.toFixed(2) + " TON";
    let startAngle = 0;

    players.forEach(p => {
        const slice = (p.bet / total) * 2 * Math.PI;
        ctx.beginPath();
        ctx.moveTo(300, 300);
        ctx.arc(300, 300, 290, startAngle, startAngle + slice);
        ctx.fillStyle = p.color;
        ctx.fill();
        
        // –†–∏—Å—É–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É –≤ —Å–µ–∫—Ç–æ—Ä–µ
        const midAngle = startAngle + slice / 2;
        ctx.save();
        ctx.translate(300 + Math.cos(midAngle) * 200, 300 + Math.sin(midAngle) * 200);
        ctx.font = "40px Arial";
        ctx.fillText(p.avatar, -20, 20);
        ctx.restore();
        
        startAngle += slice;
    });
}

// --- –õ–û–ì–ò–ö–ê –°–û–õ–û –ò–ì–† ---
const soloLogic = {
    coinFlip: (choice) => {
        const res = Math.random() > 0.5 ? '–û—Ä–µ–ª' : '–†–µ—à–∫–∞';
        return res === choice ? "WIN" : "LOSE";
    },
    russianRoulette: () => {
        const chamber = Math.floor(Math.random() * 6);
        return chamber === 0 ? "DEAD" : "SURVIVED";
    },
    knb: (userMove) => {
        const moves = ['–ö–∞–º–µ–Ω—å', '–ù–æ–∂–Ω–∏—Ü—ã', '–ë—É–º–∞–≥–∞'];
        const bot = moves[Math.floor(Math.random() * 3)];
        if (userMove === bot) return "DRAW";
        if ((userMove === '–ö–∞–º–µ–Ω—å' && bot === '–ù–æ–∂–Ω–∏—Ü—ã') || 
            (userMove === '–ù–æ–∂–Ω–∏—Ü—ã' && bot === '–ë—É–º–∞–≥–∞') || 
            (userMove === '–ë—É–º–∞–≥–∞' && bot === '–ö–∞–º–µ–Ω—å')) return "WIN";
        return "LOSE";
    },
    chips: (userPick, mines) => {
        return mines.includes(userPick) ? "BOOM" : "SAFE";
    }
};

window.onload = () => { drawWheel(); };
// --- –î–û–ë–ê–í–õ–ï–ù–ò–ï –≠–ö–†–ê–ù–ê –ü–†–û–§–ò–õ–Ø –í –°–¢–†–£–ö–¢–£–†–£ ---
const profileScreen = `
<div id="profile" class="screen">
    <div class="profile-header" style="text-align:center; margin-bottom:30px;">
        <div class="avatar-container" style="position:relative; width:90px; height:90px; margin:0 auto 15px;">
            <img src="https://via.placeholder.com/90" id="user-avatar" style="width:100%; height:100%; border-radius:50%; object-fit:cover; border:2px solid #333;">
            <div style="position:absolute; bottom:0; right:0; background:#44ff44; width:15px; height:15px; border-radius:50%; border:2px solid var(--bg);"></div>
        </div>
        <h2 id="user-username" style="font-size:22px; letter-spacing:1px;">@xdogum</h2>
    </div>

    <div class="balance-card" style="background:var(--card); border-radius:24px; padding:20px; margin-bottom:25px; display:flex; justify-content:space-between; align-items:center;">
        <div>
            <p style="font-size:12px; color:var(--dim); margin-bottom:5px;">Rolls –±–∞–ª–∞–Ω—Å</p>
            <div style="display:flex; align-items:center; gap:8px;">
                <span style="color:#4a90e2; font-size:20px;">üíé</span>
                <span id="user-ton-balance" style="font-size:20px; font-weight:bold;">0 TON</span>
            </div>
        </div>
        <div style="display:flex; gap:10px;">
            <button class="action-btn" style="background:#007aff; color:#fff; border:none; padding:12px 20px; border-radius:12px; font-weight:bold;">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
            <button class="action-btn" style="background:#222; color:#fff; border:none; padding:12px 15px; border-radius:12px;">üóí</button>
        </div>
    </div>

    <div class="menu-list" style="display:flex; flex-direction:column; gap:10px;">
        <div class="menu-item" onclick="openInventory()">
            <span class="menu-icon">üéÅ</span>
            <span class="menu-label">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø–æ–¥–∞—Ä–∫–æ–≤</span>
            <span class="menu-badge" style="background:var(--pink);">0</span>
            <span class="menu-arrow">‚ùØ</span>
        </div>
        <div class="menu-item">
            <span class="menu-icon">üìú</span>
            <span class="menu-label">–ó–∞–¥–∞–Ω–∏—è</span>
            <span class="menu-badge" style="background:#ff9800;">0 / 22</span>
            <span class="menu-arrow">‚ùØ</span>
        </div>
        <div class="menu-item">
            <span class="menu-icon">üíé</span>
            <span class="menu-label">–†–µ—Ñ–µ—Ä–∞–ª—ã</span>
            <span class="menu-arrow">‚ùØ</span>
        </div>
        <div class="menu-item">
            <span class="menu-icon">üí∞</span>
            <span class="menu-label">–°—Ç–µ–π–∫–∏–Ω–≥</span>
            <span class="menu-arrow">‚ùØ</span>
        </div>
    </div>
</div>
`;

// –ò–Ω—ä–µ–∫—Ü–∏—è –≤ HTML
document.body.insertAdjacentHTML('beforeend', profileScreen);

// --- –°–¢–ò–õ–ò –î–õ–Ø –ú–ï–ù–Æ –ü–†–û–§–ò–õ–Ø ---
const profileStyles = `
    .menu-item {
        background: var(--card);
        padding: 18px 20px;
        border-radius: 18px;
        display: flex;
        align-items: center;
        transition: 0.2s;
        cursor: pointer;
    }
    .menu-item:active { transform: scale(0.98); background: rgba(255,255,255,0.05); }
    .menu-icon { font-size: 20px; margin-right: 15px; }
    .menu-label { flex-grow: 1; font-size: 15px; font-weight: 500; }
    .menu-badge {
        padding: 2px 8px;
        border-radius: 10px;
        font-size: 11px;
        margin-right: 10px;
        font-weight: bold;
    }
    .menu-arrow { color: #333; font-size: 14px; }
`;
const styleSheet = document.createElement("style");
styleSheet.innerText = profileStyles;
document.head.appendChild(styleSheet);

// --- –õ–û–ì–ò–ö–ê –ò–ù–í–ï–ù–¢–ê–†–Ø ---
function openInventory() {
    window.Telegram.WebApp.HapticFeedback.impactOccurred('medium');
    alert("–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç. –í—ã–∏–≥—Ä—ã–≤–∞–π—Ç–µ –¥—É—ç–ª–∏, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å NFT!");
}
// --- –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò (TERMINAL BOOT) ---
const bootHTML = `
<div id="boot-screen" style="position:fixed; top:0; left:0; width:100%; height:100%; background:#000; z-index:9999; display:flex; flex-direction:column; align-items:center; justify-content:center; font-family:'JetBrains Mono', monospace; padding:20px;">
    <div id="boot-logo" style="font-size:40px; font-weight:bold; color:var(--accent); margin-bottom:30px; opacity:0; transform:scale(0.8); transition:2s;">2DUELS</div>
    <div id="boot-loader" style="width:200px; height:2px; background:#111; position:relative; margin-bottom:20px;">
        <div id="boot-bar" style="position:absolute; top:0; left:0; height:100%; width:0%; background:var(--accent); box-shadow:0 0 10px var(--accent); transition:0.5s;"></div>
    </div>
    <div id="boot-logs" style="font-size:10px; color:#444; text-align:center; height:50px; line-height:1.5;"></div>
</div>
`;

document.body.insertAdjacentHTML('afterbegin', bootHTML);

// --- –õ–û–ì–ò–ö–ê –ó–ê–ì–†–£–ó–ö–ò ---
const logs = [
    "INITIALIZING KERNEL...",
    "CONNECTING TO FIREBASE NODE...",
    "SYNCING PVP ENGINE...",
    "LOADING ASSETS: WHEEL, COIN, KNIFE...",
    "ACCESS GRANTED."
];

function startBoot() {
    const logEl = document.getElementById('boot-logs');
    const bar = document.getElementById('boot-bar');
    const logo = document.getElementById('boot-logo');
    let step = 0;

    logo.style.opacity = "1";
    logo.style.transform = "scale(1)";

    const interval = setInterval(() => {
        if (step < logs.length) {
            logEl.innerHTML = logs[step];
            bar.style.width = ((step + 1) / logs.length) * 100 + "%";
            step++;
        } else {
            clearInterval(interval);
            setTimeout(() => {
                document.getElementById('boot-screen').style.opacity = "0";
                setTimeout(() => {
                    document.getElementById('boot-screen').style.display = "none";
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp Haptics
                    if(window.Telegram.WebApp) window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
                }, 500);
            }, 800);
        }
    }, 800);
}

// --- –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ö–û–ù–û–ö –ò–ì–† (SVG/CSS) ---
function injectGameIcons() {
    const banners = document.querySelectorAll('.game-banner');
    const colors = ['#ffcc00', '#ff3333', '#00ffcc', '#ff00ff'];
    
    banners.forEach((banner, i) => {
        banner.style.borderLeft = `4px solid ${colors[i]}`;
        // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç —Å–≤–µ—á–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏/–∫–ª–∏–∫–µ
        banner.addEventListener('touchstart', () => {
            banner.style.boxShadow = `0 0 20px ${colors[i]}44`;
        });
        banner.addEventListener('touchend', () => {
            banner.style.boxShadow = "none";
        });
    });
}

// --- –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–ö–õ–ï–ô–ö–ê (APP START) ---
document.addEventListener('DOMContentLoaded', () => {
    // 1. –ó–∞–ø—É—Å–∫ –∑–∞–≥—Ä—É–∑–∫–∏
    startBoot();
    
    // 2. –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ä—É–ª–µ—Ç–∫–∏ (–∏–∑ —á–∞—Å—Ç–∏ 2)
    if(typeof drawWheel === "function") drawWheel();
    
    // 3. –ò–∫–æ–Ω–∫–∏ –∏ —Å—Ç–∏–ª–∏
    injectGameIcons();
    
    // 4. –¢–≤–æ—è —Å–∏—Å—Ç–µ–º–∞ –∑–≤–µ–∑–¥ (–º–µ—Å—Ç–æ –¥–ª—è –∫–æ–¥–∞)
    console.log("System ready for Stars integration...");
});

// –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ä–∞–Ω–µ–µ —Ç–µ–≥–∏
</script>
</body>
</html>
